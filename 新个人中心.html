<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="siteid" content="66" />
    <meta name="channelid" content="2341" />
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="images/element.css" />
    <link rel="stylesheet" type="text/css" href="images/global20240904.css" />
    <link rel="stylesheet" type="text/css" href="images/swiper.min.css" />
    <script src="images/jquery.js"></script>
    <script src="images/auth.js"></script>
    <script>
      $(function () {
        setChange($(".dw_select"));
        setChange1($(".main_search .selected li"));
        $(".close_btn").on("click", function () {
          $(".mask").removeClass("show").removeClass("top");
          $(this).parents(".tc").removeClass("show");
        });
        $(".head .search_btn").on("click", function () {
          $(".mask").addClass("show");
          $(".search_tc").css("height", $(".head").height()).addClass("show");
        });
        $(".app_head .menu_btn").on("click", function () {
          if ($(this).hasClass("show")) {
            $(this).removeClass("show");
            $(".app_menu").removeClass("show");
            $(".mask").removeClass("show");
          } else {
            $(this).addClass("show");
            $(".app_menu").addClass("show");
            $(".mask").addClass("show");
          }
        });
        $(".mask").on("click", function () {
          $(this).removeClass("show").removeClass("top");
          $("*").removeClass("show");
        });
        $(".app_head .logo .search_btn").on("click", function () {
          $(".app_search_box").addClass("show");
        });
        $(".app_menu .menu_cont ul ul").parent().addClass("hasSub");
        $(".app_menu .menu_cont a").on("click", function (event) {
          event.preventDefault();
          if ($(this).parent().hasClass("expand")) {
            $(this).parent().removeClass("expand");
          } else {
            $(this).parent().addClass("expand");
          }
          $(this).parent().children("ul").slideToggle(800);
        });
        $(".grzx .list .app .btn img").on("click", function () {
          $(this).siblings("span").addClass("show");
        });
        $(".grzx .list .app .btn span").on("click", function () {
          $(this).removeClass("show");
        });
      });
      //点击时展示，再次点击或移开鼠标隐藏
      function setChange(option) {
        option
          .on("click", function () {
            if ($(this).hasClass("show")) {
              $(this).removeClass("show");
              $(this).children("ul").hide();
            } else {
              $(this).addClass("show");
              $(this).children("ul").show();
            }
          })
          .on("mouseleave", function () {
            $(this).removeClass("show");
            $(this).children("ul").hide();
          });
      }
      function setChange1(option) {
        option.on("click", function () {
          $(this).addClass("hover").siblings().removeClass("hover");
        });
      }
      function setChange2(option) {
        var a = option.index();
        option.addClass("hover").siblings().removeClass("hover");
        option
          .parents(".tis")
          .children(".more")
          .children("a")
          .eq(a)
          .show()
          .siblings()
          .hide();
        option
          .parents(".tis")
          .siblings(".lis")
          .eq(a)
          .show()
          .siblings(".lis")
          .hide();
      }
    </script>
  </head>
  <body class="ngrzx">
    <div class="mask"></div>
    <div class="tc search_tc">
      <div class="conter">
        <div class="main_search">
          <label>
            <input
              type="text"
              autocomplete="off"
              placeholder=""
              id="search-pc"
              onkeypress="enterSearch()"
            />
            <button type="button" onclick="toSearch('search-pc')">
              <img src="images/search20240904_9.png" alt="" /><span>搜索</span>
            </button>
          </label>
          <div class="selected">
            <ul>
              <li class="hover"><a href="javascript:void(0);">全部</a></li>
              <li><a href="javascript:void(0);">关键词</a></li>
              <li><a href="javascript:void(0);">标题</a></li>
              <li><a href="javascript:void(0);">正文</a></li>
              <li><a href="javascript:void(0);">创建人</a></li>
              <li><a href="javascript:void(0);">发布时间</a></li>
              <li><a href="javascript:void(0);">分类搜索</a></li>
            </ul>
          </div>
        </div>
        <div class="close_btn">
          <img src="images/search20240904_7.png" alt="" />
        </div>
      </div>
    </div>
    <div class="app_search_box app tc">
      <label>
        <input
          type="text"
          autocomplete="off"
          placeholder="请输入关键词"
          id="search-mobile"
        />
        <button onclick="toSearch('search-mobile')">搜索</button>
      </label>
      <div class="close_btn">
        <img src="images/search20240904_7.png" alt="" />
      </div>
    </div>
    <div class="app_menu app">
      <div class="yhdl">
        <div class="yhxx">
          <img src="images/search20240904_12.png" alt="" /><em
            id="userNameMobile"
            >XXX</em
          >
          您好！
        </div>
        <div class="dl">
          <!-- <div class="login"><a href="javascript:void(0);">切换用户</a></div>
            <div class="logout"><a href="javascript:void(0);">注销</a></div> -->
        </div>
      </div>
      <div class="dw_select">
        <span>暂无信息</span>
        <ul style="display: none">
          <!-- <li><a href="">测试</a></li>
            <li><a href="">测试</a></li>
            <li><a href="">测试</a></li>
            <li><a href="">测试</a></li>
            <li><a href="">测试</a></li> -->
        </ul>
      </div>
      <div class="menu_cont">
        <ul>
          <li><a href="">首 页</a></li>
          <li>
            <a href="">集团总部新闻</a>
            <ul style="display: none">
              <li><a href="">集团要闻</a></li>
              <li><a href="">集团简讯</a></li>
              <li><a href="">公司动态</a></li>
              <li><a href="">上市公司股价</a></li>
              <li><a href="">媒体报道</a></li>
              <li><a href="">研究报告</a></li>
              <li><a href="">行业信息</a></li>
              <li><a href="">国资要闻</a></li>
            </ul>
          </li>
          <li><a href="">公司新闻</a></li>
          <li><a href="">通知与公告</a></li>
        </ul>
      </div>
      <div class="link">
        <div class="language">
          <span>简体中文</span>
          <ul style="display: none">
            <li><a href="javascript:void(0);">简体中文</a></li>
            <li><a href="javascript:void(0);">繁體中文</a></li>
          </ul>
        </div>
        <div class="wb">
          <a href="">外部网</a>
        </div>
      </div>
    </div>
    <div class="head pc">
      <div class="conter">
        <div class="top">
          <div class="left_cont">
            <div class="logo">
              <img src="images/search20240904_8.png" alt="" />
            </div>
            <div class="menu">
              <ul>
                <li class="hover"><a href="">首 页</a></li>
                <li><a href="">工作台</a></li>
                <li><a href="">集团导航</a></li>
                <li><a href="">自助服务</a></li>
              </ul>
            </div>
          </div>
          <div class="right_cont">
            <div class="yhdl">
              <div class="yhxx">
                <img src="images/search20240904_12.png" alt="" /><em
                  id="userName"
                  >XXX</em
                >
                您好！
              </div>
              <!-- <div class="login"><a href="javascript:void(0);">切换用户</a></div>
                    <div class="logout"><a href="javascript:void(0);">注销</a></div> -->
            </div>
            <div class="cont">
              <div class="search_btn">
                <img src="images/search20240904_6.png" alt="" />
              </div>
              <div class="dw_select">
                <span>暂无信息</span>
                <ul style="display: none">
                  <!-- <li><a href="">测试</a></li>
                            <li><a href="">测试</a></li>
                            <li><a href="">测试</a></li>
                            <li><a href="">测试</a></li>
                            <li><a href="">测试</a></li> -->
                </ul>
              </div>
              <div class="language">
                <a
                  name="StranLink"
                  id="StranLink"
                  title="以繁體中文查看內容"
                  class="lag"
                  href="#"
                  >繁體</a
                >
                <script src="images/zsjfjqh.js"></script>
              </div>
              <div class="wb">
                <a href="">外部网</a>
              </div>
            </div>
          </div>
        </div>
        <div class="title"><p>个人中心</p></div>
      </div>
    </div>
    <div class="app_head app">
      <div class="logo">
        <img src="images/search20240904_2.png" alt="" />
        <div class="search_btn">
          <img src="images/search20240904_4.png" alt="" />
        </div>
      </div>
      <div class="menu_btn">
        <img src="images/search20240904_5.png" alt="" /><img
          src="images/search20240904_7.png"
          alt=""
          class="hover"
        />
      </div>
    </div>
    <div class="main" id="app" style="visibility: hidden">
      <div class="lm app"><p>个人中心</p></div>
      <div class="conter" v-loading="loading">
        <div class="local"><span>我的收藏（{{page.total}}）</span></div>
        <div class="list">
          <ul>
            <li v-for="item in data">
              <div class="tit">
                <span class="fl">{{item.CHNLDESC}}</span
                ><a :href="item.DOCPUBURL">{{item.TITLE}}</a>
              </div>
              <div class="text">
                <div class="zw">
                  <p>{{item.CONTENT}}</p>
                </div>
              </div>
              <div class="info">
                <div>
                  <div class="time">{{item.DOCPUBTIME.split(' ')[0]}}</div>
                  <!-- <div class="pj">
                    <div class="gk">
                      <img src="images/search20240904_15.png" alt="" /><span
                        >104</span
                      >
                    </div>
                    <div class="pl">
                      <img src="images/search20240904_13.png" alt="" /><span
                        >89</span
                      >
                    </div>
                    <div class="sc">
                      <img src="images/ngrzx20241018_1.png" alt="" /><span
                        >34</span
                      >
                    </div>
                  </div> -->
                </div>
                <div class="cz">
                  <span class="pc btn"
                    ><a
                      href="javascript:void(0);"
                      @click="cancelFavorite(item.METADATAID)"
                      >取消收藏</a
                    ></span
                  >
                  <div class="app">
                    <!-- <img src="images/grzx20240913_6.png" alt="" /> -->
                    <div style="background-color: #0e89cd; padding: 0px 6px">
                      <a
                        href="javascript:void(0);"
                        style="color: white; font-size: smaller"
                        @click="cancelFavorite(item.METADATAID)"
                        >取消收藏</a
                      >
                    </div>
                  </div>
                </div>
              </div>
            </li>
          </ul>
          <!-- <div class="page">
            <span class="page_cont first un"><a href="">首页</a></span>
            <span class="page_cont prev un"><a href="">上一页</a></span>
            <span class="page_cont num cur"><a href="">1</a></span>
            <span class="page_cont num"><a href="">2</a></span>
            <span class="page_cont num"><a href="">3</a></span>
            <span class="page_cont num"><a href="">4</a></span>
            <span class="page_cont num"><a href="">5</a></span>
            <span class="page_cont next"><a href="">下一页</a></span>
            <span class="page_cont last"><a href="">尾页</a></span>
          </div> -->
        </div>
        <div style="display: flex; justify-content: center; margin: 10px 0">
          <el-pagination
            background
            layout="prev, pager, next"
            :total="page.total"
            :page-size="page.pageSize"
            :current-page="page.pageNum"
            @current-change="pageChange"
          >
          </el-pagination>
        </div>
        <!-- <div class="load_more app">
          <el-pagination
            size="small"
            layout="prev, pager, next"
            :total="page.total"
            :page-size="page.pageSize"
            :current-page="page.pageNum"
            @current-change="pageChange"
          >
          </el-pagination>
        </div> -->
      </div>
    </div>
    <div class="footer">
      <div class="conter">
        <p>招商局集团有限公司</p>
        <p>Cmhk © Copyright. All rights reserved</p>
      </div>
    </div>
    <script
      type="text/javascript"
      charset="utf-8"
      src="images/base64.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="images/js.cookie.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="images/axios.min.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="images/axiosConfig.js"
    ></script>
    <script
      type="text/javascript"
      charset="utf-8"
      src="images/utils.js"
    ></script>
    <script src="images/vue.min.js"></script>
    <script src="images/element.js"></script>
    <script type="module">
      var vm = new Vue({
        el: "#app",
        data() {
          return {
            searchForm: {
              methodname: "getUserFavorites",
              serviceid: "mlf_favorite",
              PAGEINDEX: 1,
              PAGESIZE: 10,
            },
            data: [],
            loading: false,
            page: {
              pageNum: 1,
              pageSize: 10,
              total: 0,
            },
          };
        },
        created() {
          document.getElementById("app").style.visibility = "visible";
          this.getData();
        },
        mounted() {
          // Translate.BindObj("StranLinkMobile", "繁體", "以繁體中文查看内容");
        },
        methods: {
          pageChange(value) {
            (this.searchForm.PAGEINDEX = value), this.getData();
          },
          cancelFavorite(id) {
            this.loading = true;
            const data = {
              methodname: "delFavorite",
              serviceid: "mlf_knowledgefavorite",
              docId: id,
              UserId: "",
            };
            trsAxios
              .get("/wcm/mlfcenter.do", {
                params: data,
              })
              .then((res) => {
                this.getData();
              });
          },
          getData() {
            $(".close_btn").click();
            this.loading = true;
            trsAxios
              .get("/wcm/mlfcenter.do", {
                params: this.searchForm,
              })
              .then((res) => {
                this.loading = false;
                if (res.DATA) {
                  this.data = res.DATA;
                  this.page = {
                    pageNum: res.PAGER.CURRPAGE*1,
                    pageSize: res.PAGER.PAGESIZE*1,
                    total: res.PAGER.ITEMCOUNT*1,
                  };
                }

                // console.log(data, "444");
              });
          },
        },
      });
    </script>
    <script>
      var keywordsType = "";
      var typeMap = {
        全部: "",
        标题: "title",
        正文: "content",
        创建人: "author",
        发布时间: "pubtime",
        分类搜索: "category",
      };
      $(".selected li a").on("click", function () {
        keywordsType = typeMap[$(this).text()];
      });

      function getUserData() {
        trsAxios
          .get(
            "/wcm/mlfcenter.do?methodname=getCurrUserInfo&serviceid=mlf_extuser"
          )
          .then((res) => {
            if (res) {
              // this.useInfo.name = res.TRUENAME;
              $("#userName").text(res.TRUENAME);
              $("#userNameMobile").text(res.TRUENAME);
              if (res.USERHEAD) {
                $(".yhxx img").attr("src", res.USERHEAD);
              }
              // console.log($('userName'));
            }
          });
      }
      getUserData();
      function enterSearch() {
        if (event.keyCode == 13) {
          toSearch("search-pc");
        }
      }
      function toSearch(value) {
        window.open(
          "https://mfs-hk.cm-worklink.com/pub/zsjjtyxgs/search/?keywords=" +
            $("#".concat(value)).val() +
            "&keywordsType=" +
            keywordsType,
          "_blank"
        );
      }

      // 24.10.23 add
      setTimeout(function () {
        document.body.style.visibility = "visible";
      }, 200);
    </script>
    <script src="images/swiper.min.js"></script>
  </body>
</html>
